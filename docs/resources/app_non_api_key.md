---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "dsm_app_non_api_key Resource - terraform-provider-dsm"
subcategory: ""
description: |-
  Creates a non API key app. The returned resource object contains the UUID of the app for further references. Default permissions of any group can be modified. Using dsm_app_non_api_key following apps can be created:
  awsxksawsiamcertificatetrustedca
---

# dsm_app_non_api_key (Resource)

Creates a non API key app. The returned resource object contains the UUID of the app for further references. Default permissions of any group can be modified. Using dsm_app_non_api_key following apps can be created:
   * `awsxks`
   * `awsiam`
   * `certificate`
   * `trustedca`

## Example Usage

```terraform
// Create groups
resource "dsm_group" "group1" {
  name = "group1"
}

resource "dsm_group" "group2" {
  name = "group2"
}

resource "dsm_group" "group3" {
  name = "group3"
}

// Create an app of type AWS XKS
resource "dsm_app_non_api_key" "aws-xks-terraform" {
  name           = "aws-xks-terraform"
  default_group  = dsm_group.group1.id
  other_group = [dsm_group.group2.id, dsm_group.group3.id]
  // other_group_permissions - to change the default permissions
  other_group_permissions = local.other_groups
  authentication_method = {
    type = "awsxks"
  }
}

/*
To modify the default group permissions, other_group_permissions can be used in a zipmap.
In the above app the following permissions are assigned for each group:
group1: SIGN,VERIFY,ENCRYPT,WRAPKEY,UNWRAPKEY,DERIVEKEY,MACGENERATE,MACVERIFY,EXPORT,MANAGE,AGREEKEY,AUDIT
group2: SIGN,VERIFY,DECRYPT,WRAPKEY,UNWRAPKEY,DERIVEKEY,MACGENERATE,MACVERIFY,EXPORT,MANAGE,AGREEKEY,AUDIT
group3: SIGN,VERIFY,ENCRYPT,DECRYPT,WRAPKEY,UNWRAPKEY,DERIVEKEY,MACGENERATE,MACVERIFY,EXPORT,MANAGE,AGREEKEY,AUDIT

For group3, default permissions are assigned as it was not specified in the other_group_permissions.
group should be specified only if default permissions need to be changed.
*/

locals {
  other_groups = zipmap(
    [
      dsm_group.group1.id,
      dsm_group.group2.id
    ],
    [
      "SIGN,VERIFY,ENCRYPT,DECRYPT,WRAPKEY,UNWRAPKEY,DERIVEKEY,MACGENERATE,MACVERIFY,EXPORT,MANAGE,AGREEKEY,AUDIT",
      "SIGN,VERIFY,DECRYPT,WRAPKEY,UNWRAPKEY,DERIVEKEY,MACGENERATE,MACVERIFY,EXPORT,MANAGE,AGREEKEY,AUDIT"
    ]
  )
}

// Create an app of type AWS IAM
resource "dsm_app_non_api_key" "aws-iam-terraform" {
  // The app name must match the AWS ARN associated with the calling entity.
  name           = "arn:aws:sts::XXXXXXXXXXXX:assumed-role/XXXXXXX>/XXXXXXX"
  default_group  = dsm_group.group2.id
  authentication_method = {
    type = "awsiam"
  }
}

// Create app of type certificate
resource "dsm_app_non_api_key" "app-certificate-terraform" {
  name           = "app-certificate-terraform"
  default_group  = dsm_group.group1.id
  authentication_method = {
    type = "certificate"
    certificate = "MIIC3jCCXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXa8YtwoA1"
  }
}

// Create an app of type Trusted CA using an ip address
resource "dsm_app_non_api_key" "app-trustedca-ip-terraform" {
  name           = "app-trustedca-ip-terraform"
  default_group  = dsm_group.group2.id
  authentication_method = {
    type = "trustedca"
    ca_certificate = "MIIC3jCCXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXa8YtwoA1"
    ip_address = "XX.XX.XX.XX"
  }
}

// Create an app of type Trusted CA using dns_name
resource "dsm_app_non_api_key" "app-trustedca-dnsname-terraform" {
  name           = "app-trustedca-dnsname-terraform"
  default_group  = dsm_group.group2.id
  authentication_method = {
    type = "trustedca"
    ca_certificate = "MIIC3jCCXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXa8YtwoA1"
    dns_name = "terraform.user.com"
  }
}

// An example on how to modify the existing permissions of a group in app
resource "dsm_app_non_api_key" "aws-xks-terraform" {
  name           = "aws-xks-terraform"
  default_group  = dsm_group.group1.id
  other_group = [dsm_group.group2.id, dsm_group.group3.id]
  // other_group_permissions - to change the default permissions
  other_group_permissions = local.other_groups
  // mod_group_permissions should be given while updating an app
  mod_group_permissions = local.mod_groups
  authentication_method = {
    type = "awsxks"
  }
}


// group1 and group2 permissions modification
locals {
  mod_groups = zipmap(
    [
      dsm_group.group1.id,
      dsm_group.group2.id
    ],
    [
      "SIGN,VERIFY,ENCRYPT,DECRYPT,WRAPKEY,DERIVEKEY,MACGENERATE,MACVERIFY,EXPORT,MANAGE,AGREEKEY,AUDIT",
      "SIGN,VERIFY,DECRYPT,UNWRAPKEY,DERIVEKEY,MACGENERATE,MACVERIFY,EXPORT,MANAGE,AGREEKEY,AUDIT"
    ]
  )
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `authentication_method` (Map of String) The Authentication type of an app.
   * `type`:  Following authentication types are supported.
       * awsxks, awsiam, certificate and trustedca.
   * `certificate`: Certificate value, this should be configured when the type is certificate.
   * `ca_certificate`: CA certificate value, this should be configured when the type is trustedca.
   One of the following parameters should be given when the type is trustedca.
   * `ip_address`:  IP address value for trusted ca.
   * `dns_name`:  DNS name for trusted ca.
   **Note**: For more details refer the above examples.
- `default_group` (String) The Fortanix DSM group object id to be mapped to the app by default.
- `name` (String) The Fortanix DSM App name.

### Optional

- `description` (String) The description of the app.
- `mod_group_permissions` (Map of String) To modify the permissions of any existing group that includes default group. Please refer the example.
- `other_group` (List of String) The Fortanix DSM group object id the app needs to be assigned to. If you want to delete the existing groups from an app, remove the ids during update.
- `other_group_permissions` (Map of String) Incase if you want to change the default permissions of a new group that includes default group. Please refer the example.

### Read-Only

- `acct_id` (String) The account ID from Fortanix DSM.
- `app_id` (String) The unique ID of the app.
- `creator` (Map of String) The creator of the app from Fortanix DSM.
   * `user`: If the app was created by a user, the computed value will be the matching user id.
   * `app`: If the app was created by a app, the computed value will be the matching app id.
- `credential` (Map of String) The Fortanix DSM App credentials. When the authentication method is awsxks, AWSXKS access and secret keys will be mapped here.
- `id` (String) The ID of this resource.
