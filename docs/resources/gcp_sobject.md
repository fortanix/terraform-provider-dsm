---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "dsm_gcp_sobject Resource - terraform-provider-dsm"
subcategory: ""
description: |-
  Creates a new security object in GCP CDC Group. This is a Bring-Your-Own-Key (BYOK) method and copies an existing DSM local security object to GCP KMS as a Customer Managed Key (CMK).
---

# dsm_gcp_sobject (Resource)

Creates a new security object in GCP CDC Group. This is a Bring-Your-Own-Key (BYOK) method and copies an existing DSM local security object to GCP KMS as a Customer Managed Key (CMK).

## Example Usage

```terraform
# Create a normal group
resource "dsm_group" "normal_group" {
  name = "group_test"
}

# Create GCP group
resource "dsm_group" "gcp_group" {
  name = "gcp_group"
  hmg = jsonencode({
    kind                  = "GCPKEYRING"
    key_ring              = "key_ring_name"
    project_id            = "gcp_project_id"
    service_account_email = "test@test.iam.gserviceaccount.com"
    location              = "us-east1"
    private_key           = "<Private component of the service account key pair that can be obtained from the GCP cloud console. It is used to authenticate the requests made by DSM to the GCP cloud. This should be base64 encoded private key.>"
  })
}

# Create an AES key in normal group
resource "dsm_sobject" "sobject" {
  name     = "aes256"
  key_size = 256
  group_id = dsm_group.normal_group.id
  obj_type = "AES"
}

# Copy a key to GCP key ring using the above DSM security object
resource "dsm_gcp_sobject" "gcp_sobject" {
  name     = "gcp_sobject"
  group_id = dsm_group.gcp_group.id
  key = {
    kid = dsm_sobject.sobject.id
  }
  custom_metadata = {
    gcp-key-id = "name-of-the-key-in-gcp"
  }
  rotation_policy = {
    interval_days = 20
    effective_at  = "20231130T183000Z"
  }
  obj_type    = "AES"
  key_size    = 256
  key_ops     = ["ENCRYPT", "DECRYPT", "WRAPKEY", "UNWRAPKEY", "DERIVEKEY", "MACGENERATE", "MACVERIFY", "APPMANAGEABLE", "EXPORT"]
  enabled     = true
  expiry_date = "2025-02-02T17:04:05Z"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `custom_metadata` (Map of String) GCP KMS key metadata information:
   * `gcp-key-id`: Key name within GCP KMS.
- `group_id` (String) The GCP group ID in Fortanix DSM where the key will be generated.
- `key` (Map of String) A local security object imported to Fortanix DSM (BYOK) and copied to GCP KMS.
- `name` (String) The security object name.

### Optional

- `description` (String) The description of the security object.
- `enabled` (Boolean) Indicates whether the security object is enabled or disabled. Values are true/false.
- `expiry_date` (String) The expiry date of the security object in RFC format.
- `key_ops` (List of String) The security object operations permitted.

| obj_type | key_size/curve | key_ops |
| -------- | -------- |-------- |
| `AES` | 256 | ENCRYPT, DECRYPT, WRAPKEY, UNWRAPKEY, DERIVEKEY, MACGENERATE, MACVERIFY, APPMANAGEABLE, EXPORT
- `key_size` (Number) The size of the security object.
- `obj_type` (String) The type of security object.
- `rotation_policy` (Map of String) Policy to rotate a security object. Configure the parameters below:
   * `interval_days`: Rotate the key every given number of days.
   * `interval_months`: Rotate the key every given number of months.
   * `effective_at`: Start time of the rotation policy.
   * **Note:** Either `interval_days` or `interval_months` should be given, but not both.
- `state` (String) The state of the GCP KMS key. Values are Created, Deleted, Purged.

### Read-Only

- `acct_id` (String) The account ID from Fortanix DSM.
- `creator` (Map of String) The creator of the security object from Fortanix DSM.
   * `user`: If the security object was created by a user, the computed value will be the matching user ID.
   * `app`: If the security object was created by an app, the computed value will be the matching app ID.
- `external` (Map of String) External metadata.
- `id` (String) The ID of this resource.
- `kid` (String) The security object ID from Fortanix DSM.
- `links` (Map of String) Link between the local security object and the GCP KMS security object.
